group_by(fetal_health) %>%
ggplot(aes(x = fetal_health, y = `baseline value`)) +
geom_boxplot(aes(fill = `baseline value`))
df_fh %>%
group_by(fetal_health) %>%
ggplot(aes(x = fetal_health, y = `baseline value`)) +
geom_boxplot(aes(colour = `baseline value`))
df_fh %>%
group_by(fetal_health) %>%
ggplot(aes(x = fetal_health, y = `baseline value`, colour = `baseline value`)) +
geom_boxplot()
df_fh %>%
group_by(fetal_health) %>%
ggplot(aes(x = fetal_health, y = `baseline value`)) +
geom_boxplot()
df_fh %>%
ggplot(aes(x = `baseline value`))+
geom_density()
df_fh %>%
ggplot(aes(x = `baseline value`, fill = fetal_health))+
geom_density(alpha = 0.5)
View(df_fh)
count(df_fh, fetal_health, percentage_of_time_with_abnormal_long_term_variability)
View(count(df_fh, fetal_health, percentage_of_time_with_abnormal_long_term_variability))
## ---- Setup -----------------------------------------------------------------
knitr::opts_chunk$set(
warning = FALSE,
message = FALSE,
cache = FALSE,
fig.align = "center",
fig.asp = 1
)
library(pacman)
p_load(ggplot2, tidyverse, here, readxl, mosaic, pwr, ggpubr, car)
theme_set(theme_light())
# Question 2
df_fh %>% group_by(`baseline value`)
# Question 2
df_fh %>% group_by(fetal_health)
mean(df_fh$`baseline value`)
# Question 2
df_fh %>% select(fetal_health == "Normal")
# Question 2
select(df_fh, fetal_health == "Normal")
# Question 2
select(df_fh, "fetal_health" == "Normal")
# Question 2
df_fh %>% filter(fetal_health == "Normal") %>%
mean(`baseline value`)
df_fh %>% filter(fetal_health == "Normal")
# Question 2
df_fh %>% filter(fetal_health == "Normal") %>%
mean(`baseline value`)
# Question 2
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
mean(df_fh_n$`baseline value`)
df_fh_n <- df_fh %>% filter(fetal_health == "Suspect")
mean(df_fh_n$`baseline value`)
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
mean(df_fh_n$`baseline value`)
df_fh_s <- df_fh %>% filter(fetal_health == "Suspect")
mean(df_fh_s$`baseline value`)
df_fh_p <- df_fh %>% filter(fetal_health == "Suspect")
mean(df_fh_p$`baseline value`)
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
mean(df_fh_n$`baseline value`)
df_fh_s <- df_fh %>% filter(fetal_health == "Suspect")
mean(df_fh_s$`baseline value`)
df_fh_p <- df_fh %>% filter(fetal_health == "Pathological")
mean(df_fh_p$`baseline value`)
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
mean(df_fh_n$uterine_contractions)
df_fh_s <- df_fh %>% filter(fetal_health == "Suspect")
mean(df_fh_s$uterine_contractions)
df_fh_p <- df_fh %>% filter(fetal_health == "Pathological")
mean(df_fh_p$uterine_contractions)
df_fh %>%
ggplot(aes(x = fetal_movement, fill = fetal_health))+
geom_density(alpha = 0.5)
df_fh %>%
ggplot(aes(x = `baseline value`, fill = fetal_health))+
geom_density(alpha = 0.5) +
scale_x_log10()
df_fh %>%
ggplot(aes(x = fetal_movement, fill = fetal_health))+
geom_density(alpha = 0.5) +
scale_x_log10()
## ---- Setup -----------------------------------------------------------------
knitr::opts_chunk$set(
warning = FALSE,
message = FALSE,
cache = FALSE,
fig.align = "center",
fig.asp = 1
)
library(pacman)
p_load(ggplot2, tidyverse, here, readxl, mosaic, pwr, ggpubr, car)
theme_set(theme_light())
# Set-up
df_fh <- readr::read_csv(here::here("fetal_health.csv")) %>%
select(!starts_with("histogram"))
# Question 1
# 1.b
df_fh$fetal_health <- ifelse(df_fh$fetal_health == 1,
"Normal",
ifelse(df_fh$fetal_health == 2,
"Suspect",
"Pathological"))
df_fh %>%
group_by(fetal_health) %>%
ggplot(aes(x = fetal_health, y = `baseline value`)) +
geom_boxplot()
## 1.d
df_fh %>%
ggplot(aes(x = `baseline value`))+
geom_density()
df_fh %>%
ggplot(aes(x = `baseline value`, fill = fetal_health))+
geom_density(alpha = 0.5)
# Question 2
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
mean(df_fh_n$uterine_contractions)
df_fh_s <- df_fh %>% filter(fetal_health == "Suspect")
mean(df_fh_s$uterine_contractions)
df_fh_p <- df_fh %>% filter(fetal_health == "Pathological")
mean(df_fh_p$uterine_contractions)
df_fh %>%
ggplot(aes(x = fetal_movement, fill = fetal_health))+
geom_density(alpha = 0.5) +
scale_x_log10()
## ---- Setup -----------------------------------------------------------------
knitr::opts_chunk$set(
warning = FALSE,
message = FALSE,
cache = FALSE,
fig.align = "center",
fig.asp = 1
)
library(pacman)
p_load(ggplot2, tidyverse, here, readxl, mosaic, pwr, ggpubr, car)
theme_set(theme_light())
df_fh %>%
select(fetal_health)%>%
filter(fetal_health != 1)%>%
nrow()
## ---- Question-5a ------------------------------------------------------------
df_fh <- readr::read_csv(here::here("fetal_health.csv"))
df_fh %>%
select(fetal_health)%>%
filter(fetal_health != 1)%>%
nrow()
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
median(df_fh_n$uterine_contractions)
df_fh_s <- df_fh %>% filter(fetal_health == "Suspect")
median(df_fh_s$uterine_contractions)
df_fh_p <- df_fh %>% filter(fetal_health == "Pathological")
median(df_fh_p$uterine_contractions)
## ---- Setup -----------------------------------------------------------------
knitr::opts_chunk$set(
warning = FALSE,
message = FALSE,
cache = FALSE,
fig.align = "center",
fig.asp = 1
)
library(pacman)
p_load(ggplot2, tidyverse, here, readxl, mosaic, pwr, ggpubr, car)
theme_set(theme_light())
# Set-up
df_fh <- readr::read_csv(here::here("fetal_health.csv")) %>%
select(!starts_with("histogram"))
#----Question 1----------
# 1.b
df_fh$fetal_health <- ifelse(df_fh$fetal_health == 1,
"Normal",
ifelse(df_fh$fetal_health == 2,
"Suspect",
"Pathological"))
df_fh %>%
group_by(fetal_health) %>%
ggplot(aes(x = fetal_health, y = `baseline value`)) +
geom_boxplot()
## 1.d
df_fh %>%
ggplot(aes(x = `baseline value`))+
geom_density()
df_fh %>%
ggplot(aes(x = `baseline value`, fill = fetal_health))+
geom_density(alpha = 0.5)
#----Question 2--------------
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
median(df_fh_n$uterine_contractions)
df_fh_s <- df_fh %>% filter(fetal_health == "Suspect")
median(df_fh_s$uterine_contractions)
df_fh_p <- df_fh %>% filter(fetal_health == "Pathological")
median(df_fh_p$uterine_contractions)
## ---- Question-5c ------------------------------------------------------------
mosaic::binom.test(x = 2, n = 10, ci.method = "Clopper-Pearson")
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(median = median(uterine_contraction)) %>%
pull(median)
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(median = median(df_fh_s$uterine_contraction)) %>%
pull(median)
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
median <- summarise(median = median(df_fh_s$uterine_contraction)) %>%
pull(median)
df_fh_s
slice_sample(n = nrow(df_fh_s), replace = T) %>%
median <- summarise(median = median(df_fh_s$uterine_contraction))
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
median <- summarise(median, median(df_fh_s$uterine_contraction)) %>%
pull(median)
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
median <- summarise(median(df_fh_s$uterine_contraction)) %>%
pull(median)
df_fh_s$uterine_contraction
df_fh_n$uterine_contractions
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
median <- summarise(median(df_fh_s$uterine_contractions)) %>%
pull(median)
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(median = median(df_fh_s$uterine_contractions)) %>%
pull(median)
R_s <- replicate(B, { # first argument, # of replicates
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(median = median(df_fh_s$uterine_contractions)) %>%
pull(median)
})
B <- 1000
R_s <- replicate(B, { # first argument, # of replicates
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(median = median(df_fh_s$uterine_contractions)) %>%
pull(median)
})
R_s
B <- 1000
R_s <- replicate(B, { # first argument, # of replicates
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(mean = mean(df_fh_s$uterine_contractions)) %>%
pull(mean)
})
mean(R_s)
R_s
#----Question 2--------------
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
mean(df_fh_n$uterine_contractions)
df_fh_s <- df_fh %>% filter(fetal_health == "Suspect")
mean(df_fh_s$uterine_contractions)
df_fh_p <- df_fh %>% filter(fetal_health == "Pathological")
mean(df_fh_p$uterine_contractions)
df_fh_p %>%
dplyr::slice_sample(n = nrow(df_fh_p), replace = T) %>%
summarise(mean = mean(df_fh_p$uterine_contractions)) %>%
pull(mean)
mean(R_p)
df_fh_p %>%
dplyr::slice_sample(n = nrow(df_fh_p), replace = T) %>%
summarise(mean = mean(df_fh_p$uterine_contractions)) %>%
pull(mean)
R_p <- replicate(B, { # first argument, # of replicates
df_fh_p %>%
dplyr::slice_sample(n = nrow(df_fh_p), replace = T) %>%
summarise(mean = mean(df_fh_p$uterine_contractions)) %>%
pull(mean)
})
mean(R_p)
R_p <- replicate(B, { # first argument, # of replicates
df_fh_p %>%
dplyr::slice_sample(n = nrow(df_fh_p), replace = T) %>%
summarise(mean = mean(df_fh_p$uterine_contractions)) %>%
pull(mean)
})
R_p <- replicate(B, { # first argument, # of replicates
df_fh_p %>%
dplyr::slice_sample(n = nrow(df_fh_p), replace = T) %>%
summarise(mean = mean(df_fh_p$uterine_contractions)) %>%
pull(mean)
})
mean(R_s)
mean(R_s)
mean(R_p)
mean(R_p)
mean(R_s)
B <- 10000
set.seed(3949)
R_s <- replicate(B, { # first argument, # of replicates
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(mean = mean(df_fh_s$uterine_contractions)) %>%
pull(mean)
})
R_s <- replicate(B, { # first argument, # of replicates
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(mean = mean(df_fh_s$uterine_contractions)) %>%
pull(mean)
})
mean(R_s)
R_p <- replicate(B, { # first argument, # of replicates
df_fh_p %>%
dplyr::slice_sample(n = nrow(df_fh_p), replace = T) %>%
summarise(mean = mean(df_fh_p$uterine_contractions)) %>%
pull(mean)
})
mean(R_p)
```{r}
mean_hr <- mean(df_fh$`baseline value`)
mean_hr
sd_hr <- sqrt(var(df_fh$`baseline value`)*(length(df_fh$`baseline value`)-1)/length(df_fh$`baseline value`))
sd_hr
pnorm(q = 141.68, mean = 133.30, sd = 9.84/sqrt(10), lower.tail = FALSE)
# cutoff to reject the null
cutoff <- qnorm(p = 0.95, mean = 133.30, sd = 9.84/sqrt(10))
cutoff
# probability of observing this cutoff or greater under the alternative
pnorm(q = cutoff, mean = 141.68, sd = 9.84/sqrt(10), lower.tail = FALSE)
set.seed(490)
power_distribution <- replicate(n = 1000, expr={
sample.size <- 10
suspect <- rnorm(sample.size, mean = 141.68, sd = 9.83)
SEM <- sd(suspect)/sqrt(sample.size)
pnorm(q = mean(suspect), mean = 133.30, sd =SEM, lower.tail = FALSE) < 0.05
} )
power_distribution <- replicate(n = 1000, expr={
sample.size <- 10
suspect <- rnorm(sample.size, mean = 141.68, sd = 9.83)
SEM <- sd(suspect)/sqrt(sample.size)
pnorm(q = mean(suspect), mean = 133.30, sd =SEM, lower.tail = FALSE) < 0.05
} )
prop.table(table(power_distribution))
prop.table(table(power_distribution))
reg2 <- glm(f_patho~ f_mov, family = binomial (link = "logit"), data = df_fh)
## ---- Setup -----------------------------------------------------------------
knitr::opts_chunk$set(
warning = FALSE,
message = FALSE,
cache = FALSE,
fig.align = "center",
fig.asp = 1
)
library(pacman)
p_load(ggplot2, tidyverse, here, readxl, mosaic, pwr, ggpubr, car)
theme_set(theme_light())
# Set-up
df_fh <- readr::read_csv(here::here("fetal_health.csv")) %>%
select(!starts_with("histogram"))
#----Question 1----------
# 1.b
df_fh$fetal_health <- ifelse(df_fh$fetal_health == 1,
"Normal",
ifelse(df_fh$fetal_health == 2,
"Suspect",
"Pathological"))
df_fh %>%
group_by(fetal_health) %>%
ggplot(aes(x = fetal_health, y = `baseline value`)) +
geom_boxplot()
## 1.d
df_fh %>%
ggplot(aes(x = `baseline value`))+
geom_density()
df_fh %>%
ggplot(aes(x = `baseline value`, fill = fetal_health))+
geom_density(alpha = 0.5)
#----Question 2--------------
df_fh_n <- df_fh %>% filter(fetal_health == "Normal")
mean(df_fh_n$uterine_contractions)
df_fh_s <- df_fh %>% filter(fetal_health == "Suspect")
mean(df_fh_s$uterine_contractions)
df_fh_p <- df_fh %>% filter(fetal_health == "Pathological")
mean(df_fh_p$uterine_contractions)
B <- 1000
set.seed(3949)
R_s <- replicate(B, { # first argument, # of replicates
df_fh_s %>%
dplyr::slice_sample(n = nrow(df_fh_s), replace = T) %>%
summarise(mean = mean(df_fh_s$uterine_contractions)) %>%
pull(mean)
})
mean(R_s)
R_p <- replicate(B, { # first argument, # of replicates
df_fh_p %>%
dplyr::slice_sample(n = nrow(df_fh_p), replace = T) %>%
summarise(mean = mean(df_fh_p$uterine_contractions)) %>%
pull(mean)
})
mean(R_p)
# 2.d
df_fh %>%
ggplot(aes(x = fetal_movement, fill = fetal_health))+
geom_density(alpha = 0.5) +
scale_x_log10()
# Question 3
mean_hr <- mean(df_fh$`baseline value`)
mean_hr
sd_hr <- sqrt(var(df_fh$`baseline value`)*(length(df_fh$`baseline value`)-1)/length(df_fh$`baseline value`))
sd_hr
pnorm(q = 141.68, mean = 133.30, sd = 9.84/sqrt(10), lower.tail = FALSE)
# cutoff to reject the null
cutoff <- qnorm(p = 0.95, mean = 133.30, sd = 9.84/sqrt(10))
cutoff
# probability of observing this cutoff or greater under the alternative
pnorm(q = cutoff, mean = 141.68, sd = 9.84/sqrt(10), lower.tail = FALSE)
set.seed(490)
power_distribution <- replicate(n = 1000, expr={
sample.size <- 10
suspect <- rnorm(sample.size, mean = 141.68, sd = 9.83)
SEM <- sd(suspect)/sqrt(sample.size)
pnorm(q = mean(suspect), mean = 133.30, sd =SEM, lower.tail = FALSE) < 0.05
} )
prop.table(table(power_distribution))
## ---- Question-5a ------------------------------------------------------------
df_fh %>%
select(fetal_health)%>%
filter(fetal_health != 1)%>%
nrow()
#there are 471 abnormal in this population
#the probability of having abnormal is 471/2126 = 0.22
1 - mosaic::xpbinom(q = 25, size = 100, prob = 0.22)
## ---- Question-5b ------------------------------------------------------------
mosaic::binom.test(x = 200, n = 1000, ci.method = "Clopper-Pearson")
mosaic::binom.test(x = 200, n = 1000, ci.method = "Wald")
mosaic::binom.test(x = 20, n = 100, ci.method = "Clopper-Pearson")
mosaic::binom.test(x = 20, n = 100, ci.method = "Wald")
## ---- Question-5c ------------------------------------------------------------
mosaic::binom.test(x = 2, n = 10, ci.method = "Clopper-Pearson")
reg1 <- lm(mean_value_of_long_term_variability ~ `baseline value`, data = df_fh)
summary(reg1)
df_fh$f_mov <- ifelse(df_fh$fetal_movement>0.01, 1, 0)
df_fh$f_patho <- ifelse(df_fh$fetal_health==3, 1 , 0)
df_fh$f_mov <- ifelse(df_fh$fetal_movement>0.01, 1, 0)
df_fh$f_patho <- ifelse(df_fh$fetal_health==3, 1 , 0)
reg2 <- glm(f_patho~ f_mov, family = binomial (link = "logit"), data = df_fh)
summary(reg2)
exp(confint(reg2))
confint(reg2)
confint(reg2)
## ---- Setup -----------------------------------------------------------------
knitr::opts_chunk$set(
warning = FALSE,
message = FALSE,
cache = FALSE,
fig.align = "center",
fig.asp = 1
)
library(pacman)
p_load(ggplot2, tidyverse, here, readxl, mosaic, pwr, ggpubr, car)
theme_set(theme_light())
# Set-up
df_fh <- readr::read_csv(here::here("fetal_health.csv")) %>%
select(!starts_with("histogram"))
df_fh$f_mov <- ifelse(df_fh$fetal_movement>0.01, 1, 0)
df_fh$f_patho <- ifelse(df_fh$fetal_health==3, 1 , 0)
reg2 <- glm(f_patho~ f_mov, family = binomial (link = "logit"), data = df_fh)
summary(reg2)
exp(confint(reg2))
exp(confint(reg2))
exp(confint(reg2))
exp(confint(reg2))[2,]
exp(confint(reg2))
?confint()
exp(stats::confint(reg2))
exp(stats::confint(reg2))
warning()
reg2
confint(reg2)
exp(confint(reg2))
conf <- confint(reg2)
conf <- confint(reg2)
exp(conf)
summary(reg2)
str(reg2)
names(reg)
names(reg2)
reg2$residuals
fmov_conf <- pnorm(c(0.025,0.975), coef(reg2)[2], 0.22181)
fmov_conf
confint(reg2)
fmov_conf <- pnorm(c(0.025,0.975), 0.43339, 0.22181)
fmov_conf
exp(confint(reg2)[2,])
p_load(ggplot2, tidyverse, here, readxl, mosaic, pwr, ggpubr, car)
exp(confint(reg2)[2,])
0.43339 + 1.96*0.22181
confint(reg2)[2,]
pnorm(c(0.025, 0.975), 0.4339, 0.2218)
pnorm(c(0.025, 0.975))
0.43339 + 1.96*0.22181
0.43339 - 1.96*0.22181
confint_upper <- 0.43339 + 1.96*0.22181
confint_lower <- 0.43339 - 1.96*0.22181
paste(confint_upper, confint_lower)
confint_upper <- exp(confint_upper)
confint_lower <- 0.43339 - 1.96*0.22181
confint_lower <- exp(confint_lower)
paste(confint_lower, confint_upper)
confint_upper <- 0.43339 + 1.96*0.22181
confint_upper <- round(exp(confint_upper),3)
confint_lower <- 0.43339 - 1.96*0.22181
confint_lower <- round(exp(confint_lower),3)
paste(confint_lower, confint_upper)
